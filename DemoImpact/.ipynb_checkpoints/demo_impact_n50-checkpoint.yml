# Define the system of units to use internally.
InternalUnitSystem:
    UnitMass_in_cgs:        1e27        # Sets Earth mass = 5.972
    UnitLength_in_cgs:      1e8         # Sets Earth radius = 6.371
    UnitVelocity_in_cgs:    1e8         # Sets time in seconds
    UnitCurrent_in_cgs:     1           # Amperes
    UnitTemp_in_cgs:        1           # Kelvin

# Parameters related to the initial conditions
InitialConditions:
    file_name:  demo_impact_n50.hdf5    # The initial conditions file to read
    periodic:   0                       # Are we running with periodic ICs?

# Parameters governing the time integration
TimeIntegration:
    time_begin:     0                   # The starting time of the simulation (in internal units).
    time_end:       3600                # REDUCED: ~1 hour simulation time (was 54000 ~15 hours)
    dt_min:         0.001               # RELAXED: Less restrictive minimum timestep
    dt_max:         100                 # REDUCED: Smaller maximum timestep for stability

# Parameters governing the snapshots
Snapshots:
    subdir:             snapshots       # Sub-directory in which to write the snapshots.
    basename:           demo_impact_n50 # Common part of the name of output files
    time_first:         0               # Time of the first output (in internal units)
    delta_time:         300             # REDUCED: More frequent outputs for testing (was 2000)

# Parameters governing the conserved quantities statistics
Statistics:
    time_first: 0                       # Time of the first output (in internal units)
    delta_time: 100                     # REDUCED: More frequent statistics

# Parameters controlling restarts
Restarts:
    enable: 0                           # Whether to enable dumping restarts at fixed intervals.

# Parameters for the hydrodynamics scheme
SPH:
    resolution_eta:     1.2348          # Target smoothing length in units of the mean inter-particle separation.
    delta_neighbours:   0.2             # RELAXED: More tolerant neighbour finding
    CFL_condition:      0.3             # RELAXED: Less restrictive CFL condition
    h_max:              2.0             # INCREASED: Allow larger smoothing lengths for stability
    viscosity_alpha:    1.0             # REDUCED: Less artificial viscosity for spinning flows
    viscosity_beta:     2.0             # REDUCED: Less artificial viscosity
    density_energy_entropy_signals_sound_speed: 1

# Parameters for the self-gravity scheme
Gravity:
    eta:                            0.05        # RELAXED: Less accurate but faster gravity
    MAC:                            geometric   # CHANGED: Faster than adaptive for small runs
    epsilon_fmm:                    0.01        # RELAXED: Less accurate but faster
    theta_cr:                       0.7         # RELAXED: Larger opening angle for speed
    max_physical_baryon_softening:  0.2         # SLIGHTLY INCREASED: For stability
    comoving_softening_ratio:       0.03        # RELAXED: For stability

# Parameters for the task scheduling
Scheduler:
    max_top_level_cells:    32          # REDUCED: Fewer top-level cells for smaller domain
    tasks_per_tick:         200         # Adjusted for better performance on laptop

# Parameters related to the equation of state
EoS:
    # Select which planetary EoS material(s) to enable for use.
    planetary_use_ANEOS_forsterite:   1     # ANEOS forsterite (Stewart et al. 2019), material ID 400
    planetary_use_ANEOS_Fe85Si15:     1     # ANEOS Fe85Si15 (Stewart 2020), material ID 402
    # Tablulated EoS file paths.
    planetary_ANEOS_forsterite_table_file:  ../EoSTables/ANEOS_forsterite_S19.txt
    planetary_ANEOS_Fe85Si15_table_file:    ../EoSTables/ANEOS_Fe85Si15_S20.txt

# Parameters for the domain decomposition
DomainDecomposition:
    mesh_type:          vector_psort    # Good for irregular distributions
    initial_type:       memory          # Better initial load balancing

# NEW: Memory and performance optimizations for laptop
Memory:
    # Conservative memory settings for laptop
    max_memory_tasks_per_rank:  500     # Limit memory usage
    memory_dump_info:           1       # Enable memory monitoring

# NEW: MPI settings optimized for 12-thread laptop
MPI:
    # If running with MPI, use appropriate settings
    mpi_threads: 4  # Uncomment if using MPI with 3 ranks Ã— 4 threads each